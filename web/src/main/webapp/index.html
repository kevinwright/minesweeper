<lift:surround with="default" at="content">
    <head>
        <link rel="stylesheet" type="text/css" href="css/minesweeper.css" />

        <script type="text/javascript" src="/js/jquery.rightClick.js" />
        <lift:mineGrid.scripts/>
        <script type="text/javascript">
            $(document).ready(function(){
                $("a.cell").click(function(event){
                    cellLeftClick(event.target.id)
                    event.preventDefault();
                });
                $("a.cell").rightClick(function(event){
                    cellRightClick(event.target.id)
                    event.preventDefault();
                });
            });

            function flip(id, newstate) {
              var cell = $('#'+id)
              cell.animate({
                height: 0,
                top: '+=12'
              }, 70, function() {
                cell.attr('class', 'cell ' + newstate)
                cell.animate({
                  height: 24,
                  top: '-=12'
                }, 100, function() {
                  //all done!
                });
              });
            }

            function cascadeGroup(ids, states) {
                if (ids.length > 0) {
                    flip(ids.shift(), states.shift())
                    cascadeGroup(ids, states)
                }
            }

            //seq = [{ids:[...],states:[...]}, {ids:[...],states:[...]}, ...]
            function cascadeSeq(seq) {
                if (seq.length > 0) {
                    var group = seq.shift()
                    cascadeGroup(group.ids, group.states)
                    setTimeout(function() {cascadeSeq(seq)},50);
                }
            }

            function updateStats(stats) {
                
            }
        </script>
    </head>

    <h2>Minesweeper!</h2>
    A demo of Lift 2.0 + Scala 2.8 running on Stax.net
    <hr/>
    <p>
      <lift:helloWorld.howdy>
        <span>The present time is: <b:time/></span>
      </lift:helloWorld.howdy>
    </p>
    <p>Left-Click to reveal a square, Right-Click to flag as a mine</p>
    <hr/>
    <p>
      <lift:mineGrid.show/>
    </p>

    <br style="clear:both"/>

    <p>
        <lift:mineGrid.stats>
            <ul>
              <li>total: <stat:total/> (<stat:visible/> revealed, <stat:notvisible/> hidden)</li>
              <li>mined: <stat:mined/> (<stat:flagged/> flagged, <stat:remaining/> remaining)</li>
            </ul>
        </lift:mineGrid.stats>
        <lift:mineGrid.reset/>
    </p>

    <br style="clear:both"/>
</lift:surround>

